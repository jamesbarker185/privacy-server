
<!DOCTYPE html>
<html>
<head>
    <title>Privacy Service Viewer</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; background: #1a1a1a; color: #e0e0e0; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; }
        .image-card { background: #2d2d2d; padding: 10px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); position: relative; }
        .image-wrapper { position: relative; display: inline-block; overflow: hidden; border-radius: 4px; }
        img { max-width: 800px; display: block; }
        
        .blur-mask { 
            position: absolute; 
            backdrop-filter: blur(15px); 
            -webkit-backdrop-filter: blur(15px);
            background-color: rgba(255, 255, 255, 0.1); /* Slight tint to make it visible if blur fails or on flat colors */
            pointer-events: none; 
            z-index: 10;
            transition: opacity 0.3s ease;
        }
        
        .controls { margin-bottom: 20px; padding: 20px; background: #2d2d2d; border-radius: 8px; text-align: center; }
        h1 { margin-top: 0; }
        
        /* Toggle Switch */
        .switch { position: relative; display: inline-block; width: 60px; height: 34px; vertical-align: middle; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 26px; width: 26px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2196F3; }
        input:checked + .slider:before { transform: translateX(26px); }
        .toggle-label { margin-left: 10px; font-size: 18px; vertical-align: middle; }
    </style>
</head>
<body>
    <div class="controls">
        <h1>Privacy Service Results</h1>
        <label class="switch">
            <input type="checkbox" id="toggle-masks" checked>
            <span class="slider"></span>
        </label>
        <span class="toggle-label">Censorship Active</span>
    </div>
    <div class="container" id="gallery"></div>

    <script>
        const images = [
            {"filename": "test_face_multiple.png", "original_filename": "original_test_face_multiple.png", "metadata": [{"label": "face", "box": [0.7656033287101248, 0.4822546972860125, 0.18446601941747573, 0.3903966597077244], "score": 1.0}, {"label": "face", "box": [0.20249653259361997, 0.4175365344467641, 0.08599167822468794, 0.16910229645093947], "score": 1.0}, {"label": "face", "box": [0.5603328710124826, 0.46764091858037576, 0.08321775312066575, 0.15866388308977036], "score": 1.0}, {"label": "face", "box": [0.8141470180305131, 0.38413361169102295, 0.07905686546463246, 0.12108559498956159], "score": 1.0}, {"label": "face", "box": [0.49514563106796117, 0.38204592901878914, 0.05547850208044383, 0.1336116910229645], "score": 1.0}, {"label": "face", "box": [0.6740638002773925, 0.32150313152400833, 0.059639389736477116, 0.12526096033402923], "score": 1.0}, {"label": "face", "box": [0.8821081830790569, 0.37995824634655534, 0.0638002773925104, 0.11482254697286012], "score": 1.0}, {"label": "face", "box": [0.15672676837725383, 0.3235908141962422, 0.04854368932038835, 0.09812108559498957], "score": 1.0}, {"label": "face", "box": [0.550624133148405, 0.29436325678496866, 0.04576976421636616, 0.081419624217119], "score": 1.0}, {"label": "face", "box": [0.406380027739251, 0.3048016701461378, 0.04160887656033287, 0.08559498956158663], "score": 1.0}, {"label": "face", "box": [0.9195561719833565, 0.21085594989561587, 0.03467406380027739, 0.07515657620041753], "score": 1.0}, {"label": "face", "box": [0.23578363384188628, 0.2797494780793319, 0.036061026352288486, 0.0709812108559499], "score": 1.0}, {"label": "face", "box": [0.9680998613037448, 0.33820459290187893, 0.03467406380027739, 0.06889352818371608], "score": 1.0}, {"label": "face", "box": [0.8141470180305131, 0.29436325678496866, 0.03467406380027739, 0.06471816283924843], "score": 1.0}, {"label": "face", "box": [0.7586685159500693, 0.24217118997912318, 0.02912621359223301, 0.05845511482254697], "score": 1.0}, {"label": "face", "box": [0.3925104022191401, 0.24217118997912318, 0.027739251040221916, 0.05219206680584551], "score": 1.0}, {"label": "face", "box": [0.9542302357836339, 0.19206680584551147, 0.023578363384188627, 0.05010438413361169], "score": 1.0}, {"label": "face", "box": [0.42718446601941745, 0.21920668058455114, 0.023578363384188627, 0.04384133611691023], "score": 1.0}]}, {"filename": "test_face_single.png", "original_filename": "original_test_face_single.png", "metadata": [{"label": "face", "box": [0.2600671140939597, 0.14035087719298245, 0.44966442953020136, 0.4423558897243108], "score": 1.0}]}, {"filename": "test_mixed.png", "original_filename": "original_test_mixed.png", "metadata": [{"label": "face", "box": [0.4956647398843931, 0.3010204081632653, 0.07803468208092486, 0.08163265306122448], "score": 1.0}, {"label": "plate", "box": [0.7875722543352601, 0.7887755102040817, 0.1893063583815029, 0.044897959183673466], "score": 1.0}]}, {"filename": "test_plate_single.png", "original_filename": "original_test_plate_single.png", "metadata": [{"label": "face", "box": [0.7606299212598425, 0.08788598574821853, 0.015748031496062992, 0.0332541567695962], "score": 1.0}, {"label": "plate", "box": [0.3889763779527559, 0.6603325415676959, 0.25196850393700787, 0.12589073634204276], "score": 1.0}]}
        ];

        const gallery = document.getElementById('gallery');
        const toggle = document.getElementById('toggle-masks');

        images.forEach(imgData => {
            const card = document.createElement('div');
            card.className = 'image-card';
            
            const wrapper = document.createElement('div');
            wrapper.className = 'image-wrapper';
            
            const img = document.createElement('img');
            img.src = imgData.original_filename; // Use original image
            wrapper.appendChild(img);
            
            imgData.metadata.forEach(obj => {
                const box = document.createElement('div');
                box.className = 'blur-mask';
                // box is [x, y, w, h] normalized
                box.style.left = (obj.box[0] * 100) + '%';
                box.style.top = (obj.box[1] * 100) + '%';
                box.style.width = (obj.box[2] * 100) + '%';
                box.style.height = (obj.box[3] * 100) + '%';
                
                // Optional: Tooltip or label on hover?
                box.title = obj.label;
                
                wrapper.appendChild(box);
            });
            
            card.appendChild(wrapper);
            
            const info = document.createElement('div');
            info.innerHTML = `<div style="margin-top:10px"><strong>${imgData.filename}</strong><br>Objects: ${imgData.metadata.length}</div>`;
            card.appendChild(info);
            
            gallery.appendChild(card);
        });

        toggle.addEventListener('change', (e) => {
            const boxes = document.querySelectorAll('.blur-mask');
            boxes.forEach(b => b.style.opacity = e.target.checked ? '1' : '0');
        });
    </script>
</body>
</html>
    